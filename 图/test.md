# 智能音乐播放系统需求规格说明书

## 1. 任务概述

### 1.1 目标

#### 应用目标
- **智能化交互**：集成手势识别与语音控制功能，实现非接触式音乐播放控制（暂停/开始/切歌）和语音搜索，提升人机交互效率。
- **用户体验优化**：通过 PyQt5 框架开发简洁美观的 GUI 界面，集成播放、搜索、歌单管理等功能，降低用户操作复杂度。
- **深度学习赋能**：基于卷积神经网络（CNN）和声学模型实现手势与语音识别的精准分类，支持 4 种手势指令和定制化语音数据集（歌手/歌曲名检索）。
- **系统扩展性**：设计模块化架构，预留接口支持后续功能扩展（如情感识别、个性化推荐）。

#### 背景与关联性
- **技术背景**：依托深度学习技术解决传统音乐播放器交互单一的问题，融合计算机视觉（手势识别）与自然语言处理（语音识别）实现创新。
- **独立性说明**：本系统为独立软件，但可与智能家居平台（如 Home Assistant）通过 API 接口集成，实现多设备联动。

---

### 1.2 系统特点

| 特性说明      | 描述                                                                 |
|---------------|----------------------------------------------------------------------|
| 多模态交互    | 同时支持手势、语音、图形界面三种控制方式                             |
| 曲库聚合      | 集成多个主流音乐平台资源                                             |
| 智能推荐      | 基于用户行为生成个性化歌单推荐                                       |
| 离线功能      | 支持本地音乐管理与下载内容播放                                       |

---

### 1.3 假定和约束

#### 开发约束
- **开发周期**：6 个月（模型训练、界面开发、集成测试等）
- **硬件依赖**：需配备摄像头（手势识别）和麦克风（语音输入），最低配置为 1080P 摄像头+双麦克风阵列。
- **数据限制**：
  - 语音数据集需包含≥500 小时中文歌曲名/歌手名音频。
  - 语音识别训练集限定在音乐领域词汇（歌手名/歌曲名）。

---

## 2. 需求规定

### 2.1 软件功能说明

| 功能模块     | 输入                     | 处理逻辑                         | 输出                | 容量指标                  |
|--------------|--------------------------|----------------------------------|---------------------|---------------------------|
| 手势控制     | 摄像头图像（30fps）      | CNN 模型分类→映射为播放指令       | 播放/暂停/切歌指令  | 支持≤5 米识别距离         |
| 语音搜索     | 麦克风音频（16kHz 采样） | 声学模型解码→文本匹配音乐库       | 歌曲列表/歌手信息   | 支持并发 3 路语音输入     |
| 播放管理     | 用户点击/指令            | 调用本地/云端音乐资源            | 音频流输出（MP3/FLAC） | 支持≥10 万首歌曲存储     |
| 界面交互     | 鼠标/触控操作            | PyQt5 事件响应→功能调用           | 可视化反馈（进度条/歌词同步） | 响应延迟≤200ms          |

**系统容量指标：**
- **支持同时在线用户数**：1000+
- **曲库容量**：支持千万级歌曲索引
- **响应延迟**：手势识别 < 200ms，语音识别 < 500ms

---

### 2.2 功能通用要求
- **统一错误提示机制**：视觉+声音反馈（如语音识别错误弹窗、手势误操作震动）。
- **全局快捷键支持**：提供常用操作快捷键（如播放/暂停、切歌等）。
- **多语言界面**：首期支持中/英文，未来扩展其他语言。
- **在线帮助文档集成**：内置图文+动画教程，支持 F1 键唤出上下文帮助。

---

### 2.3 用户界面
- **布局设计**：
  - **顶部功能区**：平台 Logo、全局搜索、语音按钮、用户中心。
  - **左侧导航栏**：发现音乐/本地歌曲/下载管理/历史记录。
  - **中央展示区**：推荐歌单（支持封面流布局）。
  - **底部控制台**：播放进度条、音量控制、歌词可视化。
  - **扩展面板**：手势识别状态指示、桌面歌词开关。
- **交互元素**：
  - **手势预览窗**：实时显示摄像头画面及识别结果（绿色框标注有效手势）。
  - **语音状态灯**：环形 LED 动态显示语音输入状态（静默/识别中/完成）。

---

### 2.4 性能要求

#### 2.4.1 精度
- **手势识别准确率**：≥97%（光照变化/遮挡场景下）。
- **语音识别词错率（WER）**：≤5%（限定歌曲名/歌手名语料）。

#### 2.4.2 时效性
| 操作类型    | 最大响应时间 |
|-------------|--------------|
| 歌曲检索    | 1.5s         |
| 手势识别    | 0.2s         |
| 语音指令执行 | 0.8s         |

#### 2.4.3 灵活性
- **自定义手势映射**：支持用户自定义手势-功能对应关系。
- **平台扩展性**：可扩展新的音乐平台接入（需提供 API 文档）。
- **主题替换**：界面主题支持 CSS 样式替换（暗/亮模式）。

---

### 2.5 数据管理
| 数据类型     | 存储方式              | 容量预估       |
|--------------|-----------------------|----------------|
| 用户偏好     | SQLite 本地数据库    | ≤50MB/用户     |
| 播放记录     | 云同步+本地缓存       | 最近 1000 条记录 |
| 模型参数     | HDF5 文件存储        | 约 800MB       |
| 音乐元数据   | SQLite/MySQL 双引擎  | ≥50 万条歌曲信息（ID3 标签） |

---

### 2.6 故障处理

| 故障类型         | 后果                   | 处理策略                                   |
|------------------|------------------------|------------------------------------------|
| 摄像头失效       | 手势功能不可用         | 自动切换为纯语音/界面控制模式并弹窗提示     |
| 语音模型崩溃     | 搜索功能中断           | 重启服务并恢复最近检查点                   |
| 平台 API 异常    | 音乐资源不可用         | 缓存机制+本地资源降级服务                  |
| 音频输出异常     | 无声/杂音              | 切换默认声卡并触发自检程序                 |

---

### 2.7 特殊要求
- **安全加密**：用户语音数据本地存储，采用 AES-256 加密传输。
- **敏感操作二次验证**：如账户注销需二次确认。
- **断点续播功能**：精确到±5 秒。
- **可靠性**：7×24 小时连续运行无故障，MTBF（平均无故障时间）≥10,000 小时。

---

## 3. 运行环境

### 3.1 硬件配置
- **最低配置**：
  - **CPU**：x86/ARM 架构（≥4 核，主频 2.0GHz）或 Intel i5 8 代。
  - **RAM**：8GB。
  - **摄像头**：720p 分辨率（支持 OpenCV）。
  - **存储空间**：5GB 可用空间。

---

### 3.2 软件依赖
| 类型             | 名称及版本               |
|------------------|--------------------------|
| **操作系统**     | Windows 10+/macOS 12+/Ubuntu 20.04+ |
| **运行时环境**   | Python 3.8+              |
| **图形框架**     | PyQt5 5.15+              |
| **深度学习框架** | TensorFlow 2.8+          |
| **依赖库**       | OpenCV 4.5、FFmpeg 4.4   |

---

### 3.3 接口规范
- **硬件接口**：
  - USB 3.0（摄像头/声卡）。
  - 蓝牙 5.0（耳机连接）。
- **软件接口**：
  - **音乐平台 API**：RESTful JSON 接口。
  - **硬件控制接口**：OpenCV 视频流接口。
  - **语音输入接口**：PortAudio 跨平台音频 I/O。
  - **实时控制指令**：WebSocket。

---

## 4. 尚需解决的问题
1. **多语种支持**：当前语音模型仅支持中文普通话，需扩展英语/方言识别。
2. **模型轻量化**：手势识别模型需优化至≤50MB（当前≥200MB）以适配嵌入式设备。
3. **版权合规**：第三方音乐平台接口授权尚未完成谈判。
4. **API 调用协调**：多平台 API 调用频次限制的优化方案。
5. **低光照手势识别**：提升手势识别在低光照环境下的性能。
6. **线程安全设计**：确保界面组件与后台服务的线程安全。